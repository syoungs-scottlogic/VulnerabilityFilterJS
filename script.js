//import vulns from "./vulns.json" assert { type: "json" };

let redList = document.getElementById("redList");

let myArr = vulns.dependencies;
let newArr = [];

for (let i = 0; i < myArr.length; i++) {
  if (myArr[i].vulnerabilities.length > 0) {
    newArr.push(myArr[i]);
  }
}

let mapArr = newArr.map((obj) => {
  return {
    name: obj.name,
    version: obj.version,
    vulnerabilities: obj.vulnerabilities,
  };
});

mapArr = uniqueArray(mapArr);

//newArr = uniqueArray(newArr);
//filterArray(newArr);

(function formatVulns() {
  // if vulns.dependancies.vulnerabilities
  // list vuln
  // remove duplicates
  console.log(mapArr);
})();

function createHtmlElement(vulnObj) {
  //
  for (let i = 0; i < vulnObj.vulnerabilities.length; i++) {
    if (vulnObj.vulnerabilities[i].severiry === "high") {
      // append vuln to red class in html
      //name, version, vuln.name, vuln.severity
      doHtml(vulnObj.vulnerabilities[i], null, null);
    }
  }
}

function doHtml(obj, sev, listID) {
  let vulnLi = document.createElement("li");
  vulnLi.innerText = obj.name;
  redList.appendChild(vulnLi);
}

function uniqueArray(arr) {
  return [...new Set(arr)];
}

function filterArray(arr) {
  let outputArr = arr.filter(function (value, index, self) {
    return index == self.indexOf(value);
  });
  return outputArr;
}
